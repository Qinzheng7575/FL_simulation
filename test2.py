import matplotlib
import matplotlib.pyplot as plt
loss_ = [2.287973165512085, 2.2766757011413574, 2.315556287765503, 2.337526798248291, 2.143500328063965, 2.267620325088501, 2.2528274059295654, 2.0731210708618164, 1.0392539501190186, 0.7440202236175537, 0.5589284896850586, 0.6748725771903992, 0.36335277557373047, 1.3610000610351562, 1.8146559000015259, 1.9908876419067383, 0.6307392716407776, 0.2919950485229492, 0.19709467887878418, 0.49001240730285645, 0.7650430202484131, 0.24412769079208374, 0.38618171215057373, 1.1121647357940674, 1.527134895324707, 1.951115608215332, 0.8452117443084717, 0.5320849418640137, 0.3521897792816162, 0.6962568163871765, 1.4287919998168945, 2.5878958702087402, 1.764716386795044, 1.190093994140625, 1.3802030086517334, 0.202417254447937, 0.20502901077270508, 0.15684401988983154, 0.22060811519622803, 0.4848957657814026, 0.273637056350708, 0.9509932994842529, 1.0758239030838013, 0.9762765765190125, 0.07847273349761963, 0.07392609119415283, 1.528303623199463, 1.5296320915222168, 0.15292775630950928, 0.250582754611969, 0.2952492833137512, 0.3771371841430664, 0.146395742893219, 0.18184947967529297, 0.3652515411376953, 0.3845973610877991, 0.18177306652069092, 0.21320664882659912, 0.0625448226928711, 0.531275749206543, 0.9920140504837036, 0.5151107311248779, 0.9964883327484131, 0.5950105786323547, 0.16247379779815674, 0.8408304452896118, 0.46723365783691406, 0.21309375762939453, 0.5549132227897644, 0.8361490964889526, 0.3555232882499695, 0.16673660278320312, 0.768264889717102, 0.6755393743515015, 1.50618314743042, 1.098345398902893, 0.4130988121032715, 0.190435528755188, 0.155228853225708, 0.6502264738082886, 0.14756429195404053, 0.2215365171432495, 0.2238650918006897, 0.37011027336120605, 0.7170910239219666, 0.9100238084793091, 0.41876327991485596, 0.21922087669372559, 0.29638439416885376, 0.19529390335083008, 0.13587749004364014, 0.1251015067100525, 0.02470099925994873, 0.21150493621826172, 0.17114579677581787, 0.09544503688812256, 0.05085325241088867, 0.3260033130645752, 0.2216973900794983, 1.5785555839538574, 0.01054692268371582, 0.929729163646698, 0.6415070295333862, 0.6140332221984863, 0.40265774726867676, 0.08285605907440186, 0.04974830150604248, 0.1572892665863037, 0.22712469100952148, 0.006065845489501953, 0.03649604320526123, 0.11363959312438965, 0.10809946060180664, 0.16144013404846191, 0.2848494052886963, 0.18116450309753418, 1.0360842943191528, 0.9293594360351562, 0.6340092420578003, 0.5831437110900879, 0.036957621574401855, 0.7405972480773926, 0.5431338548660278, 0.9366050958633423, 0.17823660373687744, 0.0751575231552124, 0.35376203060150146, 0.20528936386108398, 0.2663477659225464, 0.39318329095840454, 0.4176362156867981, 0.06052589416503906, 0.16397631168365479, 0.14083588123321533, 0.20559430122375488, 0.19219434261322021, 0.5454431772232056, 0.781582236289978, 0.0013556480407714844, 0.0017957687377929688, 0.2090139389038086, 0.10604846477508545, 0.3217571973800659, 0.061243295669555664, 0.20593667030334473, 0.23620259761810303, 0.03766286373138428, 0.019227981567382812, 0.020465850830078125, 0.008419990539550781, 0.6199117302894592, 1.7074878215789795, 0.958652138710022, 0.811819851398468, 0.0016878843307495117, 0.0027409791946411133, 0.1990882158279419, 0.17790651321411133, 0.038060784339904785, 0.003275156021118164, 0.014680743217468262, 0.02021026611328125, 0.06549489498138428, 0.12413620948791504, 0.36700403690338135, 0.2899138331413269, 0.005701780319213867, 0.02661919593811035, 0.5269840955734253, 0.7756338119506836, 0.33132052421569824, 0.002911806106567383, 0.44831979274749756, 0.03591775894165039, 0.07300162315368652, 0.08047008514404297, 0.045357465744018555, 0.015197396278381348, 0.014731645584106445, 0.012603282928466797, 0.006334662437438965, 0.004514217376708984, 0.2982988953590393, 0.21746498346328735, 0.029167890548706055, 0.021280765533447266, 0.01571190357208252, 0.02285635471343994, 0.1296612024307251, 0.10931754112243652, 0.16573894023895264, 0.04000270366668701,
         0.015433907508850098, 0.03750789165496826, 0.7953436374664307, 0.3963031768798828, 0.010556817054748535, 0.02391338348388672, 0.036544084548950195, 0.0623927116394043, 0.09031331539154053, 0.2242857813835144, 0.44164085388183594, 0.15798664093017578, 0.09076380729675293, 0.03202199935913086, 0.044884443283081055, 0.013171672821044922, 0.021510839462280273, 0.01690983772277832, 0.008959054946899414, 0.02283632755279541, 0.01063847541809082, 0.010796546936035156, 0.012442231178283691, 0.023884177207946777, 0.1089332103729248, 0.5860936641693115, 0.6972342133522034, 1.2526358366012573, 0.046697139739990234, 0.01710069179534912, 0.12812697887420654, 0.11961793899536133, 0.60807204246521, 0.7095229625701904, 0.9052649736404419, 1.0218394994735718, 0.03918886184692383, 0.33981645107269287, 0.4678148031234741, 0.4332472085952759, 0.02456951141357422, 0.015253305435180664, 0.017383217811584473, 0.3302691578865051, 0.006095409393310547, 0.00817573070526123, 0.0032966136932373047, 0.007642149925231934, 0.019794821739196777, 0.014876246452331543, 0.005868077278137207, 0.003639698028564453, 0.1620500087738037, 0.48205506801605225, 0.2564370036125183, 0.46351325511932373, 0.004868745803833008, 0.011246919631958008, 0.020946860313415527, 0.019443035125732422, 0.018713951110839844, 0.011611461639404297, 0.009438633918762207, 0.020800232887268066, 1.796715259552002, 1.286860704421997, 0.010366559028625488, 0.017110586166381836, 0.22235476970672607, 0.1249774694442749, 0.013103485107421875, 0.03678739070892334, 0.03928840160369873, 0.01736617088317871, 0.01702439785003662, 0.15876662731170654, 0.0067757368087768555, 0.00128936767578125, 0.0009326934814453125, 0.0013813972473144531, 0.011232256889343262, 0.3840670585632324, 0.3357959985733032, 0.37337350845336914, 0.028531312942504883, 0.0026944875717163086, 0.028348684310913086, 0.2427995204925537, 0.007020235061645508, 0.004631996154785156, 0.218553364276886, 0.6940450668334961, 0.17849886417388916, 0.17387354373931885, 0.20781832933425903, 0.08630132675170898, 0.4209080934524536, 0.0640714168548584, 0.07937908172607422, 0.01972365379333496, 0.007318735122680664, 0.0006051063537597656, 0.001592874526977539, 0.002612590789794922, 0.06398582458496094, 0.029120922088623047, 0.0032820701599121094, 0.0016818046569824219, 0.01951766014099121, 0.1672368049621582, 0.09529399871826172, 0.11138439178466797, 0.003504037857055664, 0.0027235746383666992, 0.0030373334884643555, 0.0009882450103759766, 0.014805793762207031, 0.01116800308227539, 0.009541869163513184, 0.14255082607269287, 0.013456106185913086, 0.017122268676757812, 0.1055593490600586, 0.41473937034606934, 0.07832551002502441, 0.6623400449752808, 0.1471719741821289, 0.21189665794372559, 0.005818009376525879, 0.009415149688720703, 0.009538531303405762, 0.18646395206451416, 0.03510689735412598, 0.0021419525146484375, 0.005469202995300293, 0.007357001304626465, 0.007273674011230469, 0.0037992000579833984, 0.0009799003601074219, 0.00426483154296875, 0.6455991268157959, 0.5542206764221191, 0.11993348598480225, 0.011486053466796875, 0.0008983612060546875, 0.001119375228881836, 0.018940210342407227, 0.008397698402404785, 0.08444881439208984, 0.013382196426391602, 0.09887707233428955, 0.3250274360179901, 0.05754566192626953, 0.08041822910308838, 0.027216792106628418, 0.032491087913513184, 0.0027627944946289062, 0.00015544891357421875, 0.037956953048706055, 0.13111627101898193, 0.02066183090209961, 0.010478019714355469, 0.010713577270507812, 0.04698193073272705, 0.03542482852935791, 0.017796874046325684, 0.008661508560180664, 0.012778520584106445, 0.0057353973388671875, 1.9312394857406616, 1.5179245471954346, 1.235576868057251, 0.02967989444732666, 0.008675098419189453, 0.008173227310180664, 0.006954073905944824, 0.001630544662475586, 0.001936197280883789, 0.002155303955078125, 0.0028481483459472656, 0.003160238265991211, 0.01591956615447998, 0.008267641067504883, 0.03551769256591797]

loss_pro = [2.29453706741333, 2.3009891510009766, 2.289170742034912, 2.3478097915649414, 2.078796863555908, 2.131495237350464, 2.0943496227264404, 2.0949597358703613, 1.2277700901031494, 1.338019609451294, 1.3907588720321655, 1.532585859298706, 1.5016658306121826, 1.0048784017562866, 0.7550618052482605, 1.4449396133422852, 0.22680318355560303, 0.2601325511932373, 0.2970694303512573, 0.5520918965339661, 0.6279066801071167, 0.3316645622253418, 0.4494711756706238, 0.5857257843017578, 0.7833284139633179, 0.7648861408233643, 0.9524838328361511, 0.5140473246574402, 1.120539903640747, 1.4564764499664307, 2.1110825538635254, 1.1087315082550049, 0.3236809968948364, 0.6876809000968933, 1.7102900743484497, 1.8025404214859009, 0.6782899498939514, 0.5758169889450073, 0.5899262428283691, 0.622704267501831, 0.16543370485305786, 0.08877837657928467, 0.8300604820251465, 1.2776336669921875, 0.9435619115829468, 0.029641389846801758, 0.022276639938354492, 0.14242660999298096, 0.024123311042785645, 0.08192288875579834, 0.5318038463592529, 0.2588173747062683, 0.16239869594573975, 0.07125401496887207, 0.0477449893951416, 0.07210469245910645, 0.3691977262496948, 0.614830732345581, 0.9237189292907715, 0.5540194511413574, 0.19297939538955688, 0.20423007011413574, 0.24184811115264893, 0.6380447149276733, 0.15993720293045044, 0.036800503730773926, 0.06398153305053711, 0.10594475269317627, 0.35679566860198975, 1.34799063205719, 1.735731840133667, 0.6288280487060547, 0.23936164379119873, 1.0673526525497437, 1.8580071926116943, 2.7610909938812256, 0.271112322807312, 0.16503262519836426, 0.09200239181518555, 0.14216411113739014, 0.08774209022521973, 0.02809929847717285, 0.01963210105895996, 0.03770339488983154, 0.0906602144241333, 0.1316359043121338, 0.33357274532318115, 0.6172245740890503, 1.182671308517456, 0.7551328539848328, 0.4147784113883972, 0.38745057582855225, 0.2160865068435669, 0.21291053295135498, 0.1696023941040039, 0.03203284740447998, 0.5654706954956055, 0.632994532585144, 0.5957942008972168, 0.551037609577179, 0.30394357442855835, 0.7020857334136963, 1.0326850414276123, 0.6621670722961426, 0.031322360038757324, 0.010883331298828125, 0.002397298812866211, 0.03560638427734375, 0.2410191297531128, 0.19040560722351074, 0.906663179397583, 0.40869903564453125, 0.022749662399291992, 0.02109384536743164, 0.0035114288330078125, 0.0039784908294677734, 0.08988010883331299, 0.10761308670043945, 0.20601683855056763, 0.34410780668258667, 0.7264212369918823, 0.767773449420929, 0.23110747337341309, 0.04874086380004883, 0.12083399295806885, 0.04631686210632324, 0.0654456615447998, 0.062055230140686035, 0.04381251335144043, 0.050987958908081055, 0.09196114540100098, 0.06456124782562256, 0.33853137493133545, 0.661202609539032, 0.2660561800003052, 0.23215210437774658, 0.11969649791717529, 0.07608699798583984, 0.1082838773727417, 0.010682106018066406, 0.3415147066116333, 0.12619376182556152, 0.04155302047729492, 0.06965315341949463, 0.03119063377380371, 0.07195580005645752, 0.16050755977630615, 0.027484774589538574, 0.14852488040924072, 0.2481755018234253, 0.12917888164520264, 0.2873634099960327, 0.014841198921203613, 0.0267331600189209, 0.042868614196777344, 0.03777480125427246, 0.022652506828308105, 0.027559995651245117, 0.009464859962463379, 0.04511666297912598, 0.13644921779632568, 0.13857126235961914, 0.06096446514129639, 0.050194740295410156, 0.05624127388000488, 0.17262887954711914, 0.01876986026763916, 0.02146279811859131, 0.08106815814971924, 0.07312798500061035, 0.06196033954620361, 0.15253818035125732, 0.026239514350891113, 0.014163732528686523, 0.03894388675689697, 0.04345107078552246, 0.0033338069915771484, 0.3744208514690399, 0.22636574506759644, 0.4107969403266907, 0.02669680118560791, 0.04342377185821533, 0.03595912456512451, 0.0195767879486084, 0.0030933618545532227, 0.019469857215881348, 0.49305492639541626, 0.2040107250213623, 0.013515591621398926, 0.010499715805053711, 0.012062907218933105, 0.0204087495803833,
            0.014102697372436523, 0.009990572929382324, 0.11344826221466064, 0.12377774715423584, 0.05261993408203125, 0.02886974811553955, 0.03932058811187744, 0.29300034046173096, 0.003793478012084961, 0.022256970405578613, 0.007647991180419922, 0.004744052886962891, 0.49223047494888306, 0.32871901988983154, 0.27851271629333496, 0.1252819299697876, 0.20614981651306152, 0.12772631645202637, 0.2503018379211426, 0.1033318042755127, 0.7026610374450684, 0.0756688117980957, 0.009621024131774902, 0.19711625576019287, 0.027591943740844727, 0.6641426682472229, 0.6155933737754822, 0.841742217540741, 0.12501215934753418, 0.25016623735427856, 0.32368743419647217, 0.11063730716705322, 0.018258213996887207, 0.021009325981140137, 0.007555127143859863, 0.02151930332183838, 0.246637225151062, 0.0073699951171875, 0.005640983581542969, 0.019245386123657227, 0.028407812118530273, 0.031121253967285156, 0.013164281845092773, 0.008780241012573242, 0.0191495418548584, 0.03773033618927002, 0.1721130609512329, 0.3254830241203308, 0.01460719108581543, 0.04531753063201904, 0.015521049499511719, 0.0023627281188964844, 0.42207109928131104, 0.6501413583755493, 0.6984624862670898, 0.05479753017425537, 0.04628956317901611, 0.00044155120849609375, 0.006867766380310059, 0.0052340030670166016, 0.49615490436553955, 0.4024965763092041, 0.4739021360874176, 0.02146017551422119, 0.017712950706481934, 0.00747990608215332, 0.012048006057739258, 0.5081977844238281, 0.00541377067565918, 0.02525913715362549, 0.058864712715148926, 0.044458746910095215, 0.04109811782836914, 0.002074003219604492, 0.0024840831756591797, 0.002887248992919922, 0.05402970314025879, 0.0016396045684814453, 0.004141807556152344, 0.010472655296325684, 0.010913610458374023, 0.0004019737243652344, 0.0012383460998535156, 0.005522966384887695, 0.011257648468017578, 0.0035774707794189453, 0.01336824893951416, 0.010653853416442871, 2.6665918827056885, 2.358368396759033, 2.156317710876465, 1.591156244277954, 0.4249570667743683, 0.42417389154434204, 0.23657196760177612, 0.06845521926879883, 0.005818843841552734, 0.2550067901611328, 0.04419708251953125, 0.11350369453430176, 0.24515998363494873, 0.24929583072662354, 0.5919623374938965, 0.07880151271820068, 0.14450812339782715, 0.11208951473236084, 0.028287172317504883, 0.04459488391876221, 0.17371630668640137, 0.06294596195220947, 0.004273414611816406, 0.00475764274597168, 0.009012699127197266, 0.08862483501434326, 0.1505906581878662, 0.13176488876342773, 1.6526424884796143, 0.018782854080200195, 0.005104780197143555, 0.005279064178466797, 0.006029963493347168, 0.0033416748046875, 0.00014328956604003906, 0.000690460205078125, 0.010324716567993164, 0.03808450698852539, 0.03508615493774414, 0.017438054084777832, 0.010717988014221191, 0.042769551277160645, 0.058092713356018066, 0.09515893459320068, 0.020103931427001953, 0.001589059829711914, 0.0053730010986328125, 0.017326831817626953, 0.042769432067871094, 0.05354022979736328, 0.011076927185058594, 0.0034716129302978516, 0.6457614302635193, 0.7203287482261658, 0.37865376472473145, 0.03929328918457031, 0.01398313045501709, 0.010630369186401367, 0.006242990493774414, 0.008614301681518555, 0.010562419891357422, 0.0005881786346435547, 0.0005083084106445312, 0.004061698913574219, 0.0007436275482177734, 0.019958972930908203, 0.18861114978790283, 0.11012077331542969, 0.014958620071411133, 0.004723548889160156, 0.015959978103637695, 0.0007193088531494141, 0.28724974393844604, 0.3344985246658325, 0.0009694099426269531, 0.0007910728454589844, 0.007444024085998535, 0.012282490730285645, 0.12487292289733887, 0.17647218704223633, 0.005471944808959961, 0.002386331558227539, 0.0026051998138427734, 0.0056002140045166016, 0.017125964164733887, 0.0061495304107666016, 0.0021011829376220703, 0.00019407272338867188, 0.019504904747009277, 0.004725813865661621, 0.006220459938049316, 9.703636169433594e-05, 0.0032994747161865234, 0.0014405250549316406, 0.006683826446533203, 0.01727759838104248]
x = range(1, len(loss_)+1)
plt.plot(x, loss_, '.-', color='r', label='before')
plt.plot(x, loss_pro, '--', color='b', label='after')
plt.ylabel('Training loss')
plt.xlabel('batches')
plt.legend(loc=0)
plt.show()
